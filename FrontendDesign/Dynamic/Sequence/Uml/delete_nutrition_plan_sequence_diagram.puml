@startuml delete_nutrition_plan_sequence_diagram

!pragma layout smetana

title Biểu đồ Tuần tự - Xóa Chế độ Dinh dưỡng

actor "Người dùng" as User
participant "NutritionPlanPageUI" as UI
participant "NutritionService" as Service
participant "CheDoDinhDuongDAO" as DAO
participant "Cơ sở dữ liệu" as DB

User -> UI: Truy cập trang Quản lý Chế độ Dinh dưỡng
activate UI
UI --> User: Hiển thị danh sách chế độ dinh dưỡng

User -> UI: Chọn chế độ dinh dưỡng để xóa (maCheDo)
activate UI
UI --> User: Hiển thị hộp thoại xác nhận xóa

User -> UI: Xác nhận xóa
UI -> UI: xoaCheDo(maCheDo: string)
activate UI
deactivate UI
UI -> Service: xoaCheDoDinhDuong(maCheDo: string)
activate Service
Service -> DAO: delete(maCheDo: string)
activate DAO
DAO -> DB: DELETE FROM CheDoDinhDuong WHERE maCheDo = maCheDo
activate DB
DB --> DAO: Trả về kết quả (true/false)
deactivate DB
DAO --> Service: Trả về true/false
deactivate DAO
Service --> UI: true / false
deactivate Service

alt Xóa thành công
  UI -> UI: hienThiThongBao("Xóa thành công", "success")
  activate UI
  deactivate UI
  UI -> Service: layTatCaCheDoDinhDuong()
  activate Service
  Service -> DAO: findAll()
  activate DAO
  DAO -> DB: SELECT * FROM CheDoDinhDuong
  activate DB
  DB --> DAO: Trả về danh sách chế độ dinh dưỡng
  deactivate DB
  DAO --> Service: Trả về danh sách CheDoDinhDuong
  deactivate Service
  UI -> UI: hienThiDanhSachCheDo(plans: CheDoDinhDuongData[])
  activate UI
  deactivate UI
else Xóa thất bại
  UI -> UI: hienThiThongBao("Xóa thất bại", "error")
  activate UI
  deactivate UI
end
deactivate UI

@enduml
