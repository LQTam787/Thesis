@startuml ShareSequence
!theme vibrant

title Biểu đồ Tuần tự cho Chức năng Chia sẻ

actor "Người dùng" as User
participant "ShareScreen" as Screen
participant "PostController" as Controller
participant "PostService" as Service
participant "PostRepository" as Repository
participant "AIService" as AIService

User -> Screen: Nhấn nút "Chia sẻ"
activate Screen
Screen -> Screen: showShareDialog()
User -> Screen: Nhập nội dung, chọn chế độ và nhấn "Đăng"
Screen -> Controller: sharePost(postDTO)
activate Controller

Controller -> Service: createPost(postDTO)
activate Service

Service -> Repository: findById(userId)
activate Repository
Repository --> Service: user
deactivate Repository

Service -> Repository: findById(sharedObjectId)
activate Repository
Repository --> Service: sharedObject
deactivate Repository

Service -> Service: Tạo đối tượng Post

Service -> Repository: save(post)
activate Repository
Repository --> Service: savedPost
deactivate Repository

Service -> AIService: findSimilarUsers(post)
activate AIService
AIService --> Service: Gợi ý người dùng
deactivate AIService

Service --> Controller: post
deactivate Service

Controller --> Screen: ResponseEntity (201 Created)
deactivate Controller

Screen --> User: Hiển thị bài viết mới
deactivate Screen

@enduml
