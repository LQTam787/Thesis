@startuml NutritionPlanManagementActivity
!theme vibrant
title Biểu đồ Hoạt động cho Chức năng Quản lý Kế hoạch Dinh dưỡng

start

:Người dùng chọn chức năng "Lập kế hoạch dinh dưỡng";

if (Tạo kế hoạch mới?) then (yes)
    :Hệ thống hiển thị giao diện tạo kế hoạch;
    :Người dùng nhập thông tin chi tiết cho kế hoạch
(Tên kế hoạch, mục tiêu, các bữa ăn, thực phẩm, công thức, thời gian); 
    :Hệ thống nhận và xác thực dữ liệu;
    :Gọi AI Engine để tính toán tổng Calo và Macronutrients;
    :So sánh kết quả tính toán với mục tiêu của người dùng;
    if (Có chênh lệch lớn?) then (yes)
        :Hiển thị cảnh báo và gợi ý điều chỉnh;
        :Người dùng điều chỉnh kế hoạch;
        repeat
            :Người dùng cập nhật thông tin bữa ăn;
            :Hệ thống tính toán lại dinh dưỡng;
        repeat while (Vẫn còn chênh lệch lớn?)
    endif
    :Lưu kế hoạch dinh dưỡng vào cơ sở dữ liệu;
    :Hệ thống tạo danh sách mua sắm (Checklist) dựa trên kế hoạch;
    :Hệ thống tạo các mẹo và lời nhắc hàng ngày;
    :Hiển thị kế hoạch hoàn chỉnh cho người dùng;
else (no)
    :Hệ thống hiển thị danh sách các kế hoạch mẫu;
    :Người dùng chọn một kế hoạch mẫu;
    :Hệ thống hiển thị chi tiết kế hoạch mẫu;
    :Người dùng xác nhận sử dụng kế hoạch này;
    :Lưu lựa chọn của người dùng;
endif

stop

@enduml
