@startuml RegistrationSequenceDiagram
' Sequence Diagram for User Registration

title Biểu đồ Tuần tự cho chức năng Đăng ký

actor "Người dùng" as User
participant "Giao diện Đăng ký" as RegistrationUI
participant "Controller Xác thực" as AuthController
participant "Cơ sở dữ liệu" as DB

User -> RegistrationUI: 1. Yêu cầu đăng ký
activate RegistrationUI

RegistrationUI -> User: 2. Hiển thị form đăng ký

User -> RegistrationUI: 3. Nhập thông tin (tên, email, username, password)
User -> RegistrationUI: 4. Xác nhận đăng ký

RegistrationUI -> AuthController: 5. register(userInfo)
activate AuthController

AuthController -> DB: 6. findUser(username, email)
activate DB
DB --> AuthController: 7. userExistsStatus
deactivate DB

alt Thông tin hợp lệ và người dùng chưa tồn tại
    AuthController -> AuthController: 8. hashPassword(password)
    AuthController -> DB: 9. saveUser(newUser)
    activate DB
    DB --> AuthController: 10. saveStatus
    deactivate DB

    AuthController --> RegistrationUI: 11. registrationSuccess()
    RegistrationUI --> User: 12. Thông báo đăng ký thành công và chuyển hướng
else Thông tin không hợp lệ hoặc người dùng đã tồn tại
    AuthController --> RegistrationUI: 11a. registrationFailed(error)
    RegistrationUI --> User: 12a. Hiển thị thông báo lỗi
end

deactivate AuthController
deactivate RegistrationUI

@enduml
