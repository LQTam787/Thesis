<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quản lý Kế hoạch Dinh dưỡng</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f9;
            color: #333;
            margin: 0;
            padding: 20px;
        }
        .container {
            max-width: 1200px;
            margin: auto;
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h1, h2 {
            color: #4CAF50;
        }
        .plan-list, .plan-details, .add-plan-form {
            margin-bottom: 20px;
        }
        .plan-item {
            background: #e8f5e9;
            padding: 15px;
            border-left: 5px solid #4CAF50;
            margin-bottom: 10px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .plan-item:hover {
            background-color: #dcedc8;
        }
        #planDetailsContent, #addPlanFormContainer {
            display: none;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 5px;
            margin-top: 10px;
        }
        .meal {
            margin-bottom: 15px;
        }
        .meal h4 {
            margin-bottom: 5px;
            color: #2e7d32;
        }
        ul {
            list-style-type: none;
            padding-left: 0;
        }
        li {
            background: #f1f8e9;
            padding: 8px;
            margin-bottom: 5px;
            border-radius: 4px;
        }
        button {
            background-color: #4CAF50;
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background-color: #45a049;
        }
        input[type="text"], input[type="date"], input[type="number"] {
            width: calc(100% - 22px);
            padding: 10px;
            margin-bottom: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        label {
            font-weight: bold;
            display: block;
            margin-bottom: 5px;
        }
    </style>
</head>
<body>

<div class="container">
    <h1>Module Quản lý Kế hoạch Dinh dưỡng</h1>

    <!-- Hidden fields for state management -->
    <input type="hidden" id="currentUserId" value="user123">
    <input type="hidden" id="currentPlanId" value="">

    <div class="plan-list">
        <h2>Danh sách Kế hoạch</h2>
        <div id="plansContainer">
            <!-- Dữ liệu giả lập sẽ được chèn vào đây bởi JavaScript -->
        </div>
        <button onclick="showAddPlanForm()">Thêm Kế hoạch Mới</button>
    </div>

    <div class="add-plan-form">
        <div id="addPlanFormContainer">
            <h2>Thêm Kế hoạch Mới</h2>
            <form id="addPlanForm" onsubmit="addPlan(event)">
                <label for="planName">Tên Kế hoạch:</label>
                <input type="text" id="planName" name="planName" required>

                <label for="startDate">Ngày bắt đầu:</label>
                <input type="date" id="startDate" name="startDate" required>

                <label for="endDate">Ngày kết thúc:</label>
                <input type="date" id="endDate" name="endDate" required>

                <label for="totalCaloriesGoal">Mục tiêu Calo/ngày:</label>
                <input type="number" id="totalCaloriesGoal" name="totalCaloriesGoal" required>

                <button type="submit">Lưu Kế hoạch</button>
                <button type="button" onclick="hideAddPlanForm()">Hủy</button>
            </form>
        </div>
    </div>

    <div class="plan-details">
        <div id="planDetailsContent">
            <h2 id="planDetailsTitle">Chi tiết Kế hoạch</h2>
            <div id="dailyMenusContainer">
                <!-- Chi tiết thực đơn hàng ngày sẽ được chèn vào đây -->
            </div>
        </div>
    </div>
</div>

<script>
    // Dữ liệu giả lập
    const mockData = {
        plans: [
            { id: 'plan01', name: 'Kế hoạch giảm cân 7 ngày', startDate: '2024-05-01', endDate: '2024-05-07', totalCaloriesGoal: 1500 },
            { id: 'plan02', name: 'Kế hoạch tăng cơ', startDate: '2024-05-10', endDate: '2024-05-24', totalCaloriesGoal: 2500 }
        ],
        dailyMenus: {
            'plan01': [
                {
                    date: '2024-05-01',
                    meals: [
                        { type: 'Bữa sáng', time: '07:00', items: [{ name: 'Yến mạch', quantity: 50, unit: 'g' }, { name: 'Chuối', quantity: 1, unit: 'quả' }] },
                        { type: 'Bữa trưa', time: '12:00', items: [{ name: 'Ức gà luộc', quantity: 150, unit: 'g' }, { name: 'Gạo lứt', quantity: 100, unit: 'g' }] },
                        { type: 'Bữa tối', time: '19:00', items: [{ name: 'Salad rau xanh', quantity: 200, unit: 'g' }, { name: 'Cá hồi áp chảo', quantity: 120, unit: 'g' }] }
                    ]
                }
            ]
        }
    };

    function renderPlans() {
        const plansContainer = document.getElementById('plansContainer');
        plansContainer.innerHTML = '';
        mockData.plans.forEach(plan => {
            const planElement = document.createElement('div');
            planElement.className = 'plan-item';
            planElement.innerHTML = `<strong>${plan.name}</strong><br><em>${plan.startDate} - ${plan.endDate}</em>`;
            planElement.onclick = () => showPlanDetails(plan.id);
            plansContainer.appendChild(planElement);
        });
    }

    function showPlanDetails(planId) {
        document.getElementById('currentPlanId').value = planId;
        const plan = mockData.plans.find(p => p.id === planId);
        const menus = mockData.dailyMenus[planId] || [];

        const detailsContent = document.getElementById('planDetailsContent');
        const title = document.getElementById('planDetailsTitle');
        const menusContainer = document.getElementById('dailyMenusContainer');

        title.innerText = `Chi tiết: ${plan.name}`;
        menusContainer.innerHTML = '';

        if (menus.length > 0) {
            menus.forEach(menu => {
                const menuElement = document.createElement('div');
                menuElement.innerHTML = `<h3>Thực đơn ngày: ${menu.date}</h3>`;
                menu.meals.forEach(meal => {
                    const mealElement = document.createElement('div');
                    mealElement.className = 'meal';
                    let itemsHtml = '<ul>';
                    meal.items.forEach(item => {
                        itemsHtml += `<li>${item.name} - ${item.quantity} ${item.unit}</li>`;
                    });
                    itemsHtml += '</ul>';
                    mealElement.innerHTML = `<h4>${meal.type} (${meal.time})</h4>${itemsHtml}`;
                    menuElement.appendChild(mealElement);
                });
                menusContainer.appendChild(menuElement);
            });
        } else {
            menusContainer.innerHTML = '<p>Chưa có thực đơn chi tiết cho kế hoạch này.</p>';
        }

        detailsContent.style.display = 'block';
        hideAddPlanForm();
    }

    function showAddPlanForm() {
        document.getElementById('addPlanFormContainer').style.display = 'block';
        document.getElementById('planDetailsContent').style.display = 'none';
    }

    function hideAddPlanForm() {
        document.getElementById('addPlanFormContainer').style.display = 'none';
        document.getElementById('addPlanForm').reset();
    }

    function addPlan(event) {
        event.preventDefault();
        const newPlan = {
            id: 'plan' + Date.now(),
            name: document.getElementById('planName').value,
            startDate: document.getElementById('startDate').value,
            endDate: document.getElementById('endDate').value,
            totalCaloriesGoal: document.getElementById('totalCaloriesGoal').value
        };
        mockData.plans.push(newPlan);
        renderPlans();
        hideAddPlanForm();
        alert('Đã thêm kế hoạch thành công!');
    }

    // Khởi tạo giao diện
    document.addEventListener('DOMContentLoaded', renderPlans);

</script>
</body>
</html>
